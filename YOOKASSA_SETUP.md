# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ YooKassa –¥–ª—è –æ–ø–ª–∞—Ç—ã

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

### Backend:
1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `@a2seven/yoo-checkout` SDK
2. ‚úÖ –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `/src/payment/YooKassa.js` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏
3. ‚úÖ –°–æ–∑–¥–∞–Ω –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ `/src/shop/Products.js` —Å –º–µ–¥–≤–µ–∂–æ–Ω–∫–æ–º —Ä–∏–ª—Å–º–µ–π–∫–µ—Ä–æ–º
4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
   - `GET /api/products` - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
   - `GET /api/products/:productId` - –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–≤–∞—Ä
   - `POST /api/payment/create` - —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç—ë–∂
   - `GET /api/payment/status/:paymentId` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞
   - `POST /api/payment/webhook` - webhook –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç YooKassa

### Frontend:
1. ‚úÖ –°–æ–∑–¥–∞–Ω —ç–∫—Ä–∞–Ω –º–∞–≥–∞–∑–∏–Ω–∞ `/screens/shop/ShopScreen.jsx`
2. ‚úÖ –°–æ–∑–¥–∞–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–∞ `/components/app/shop/ProductCard.jsx`
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ä–æ—É—Ç `/shop` –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ú–∞–≥–∞–∑–∏–Ω" –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞:

### 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª `/root/telegram-mini-app/telegram-mini-app/template/backend/.env`:

```env
# YooKassa credentials
YOOKASSA_SHOP_ID=1071932
YOOKASSA_SECRET_KEY=live_hWErqH3d4iabfytcNhbWqttodx4d72oBKRvuGpoh_uU
```

**–í–∞–∂–Ω–æ:** Shop ID –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ YooKassa (yookassa.ru)

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–µ–Ω–¥

```bash
pm2 restart telegram-bot
```

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –≤ YooKassa (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å—Ç–∞—Ç—É—Å–µ –ø–ª–∞—Ç–µ–∂–µ–π:
1. –ó–∞–π–¥–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç YooKassa
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞
3. –î–æ–±–∞–≤—å—Ç–µ webhook URL: `https://telegramwebapp.webtm.ru/api/payment/webhook`
4. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è: `payment.succeeded`, `payment.canceled`

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–ø–ª–∞—Ç–∞:

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω (`/shop`)
2. –í–∏–¥–∏—Ç –∫–∞—Ä—Ç–æ—á–∫—É —Ç–æ–≤–∞—Ä–∞ "–ú–µ–¥–≤–µ–∂–æ–Ω–æ–∫ –†–∏–ª—Å–º–µ–π–∫–µ—Ä" (990‚ÇΩ)
3. –ù–∞–∂–∏–º–∞–µ—Ç "–ö—É–ø–∏—Ç—å"
4. –°–æ–∑–¥–∞—ë—Ç—Å—è –ø–ª–∞—Ç—ë–∂ —á–µ—Ä–µ–∑ YooKassa API
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã YooKassa
6. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã YooKassa –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook –Ω–∞ –Ω–∞—à —Å–µ—Ä–≤–µ—Ä
7. –ú–æ–∂–Ω–æ –≤—ã–¥–∞—Ç—å —Ç–æ–≤–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ webhook

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–æ–≤–∞—Ä–∞:

```javascript
{
    id: 'teddy_reelsmaker',
    name: '–ú–µ–¥–≤–µ–∂–æ–Ω–æ–∫ –†–∏–ª—Å–º–µ–π–∫–µ—Ä',
    description: '–ú–∏–ª—ã–π –º–µ–¥–≤–µ–∂–æ–Ω–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤–∏—Ä—É—Å–Ω—ã–µ —Ä–∏–ª—Å—ã',
    price: 990, // –≤ —Ä—É–±–ª—è—Ö
    currency: 'RUB',
    image: 'üß∏',
    type: 'digital'
}
```

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤:

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `/root/telegram-mini-app/telegram-mini-app/template/backend/src/shop/Products.js`:

```javascript
export const PRODUCTS = {
    'teddy_reelsmaker': { /* ... */ },
    'new_product': {
        id: 'new_product',
        name: '–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞',
        description: '–û–ø–∏—Å–∞–Ω–∏–µ',
        price: 1990,
        currency: 'RUB',
        image: 'üéÅ',
        type: 'digital'
    }
}
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Mini App –≤ Telegram
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ú–∞–≥–∞–∑–∏–Ω"
3. –ù–∞–∂–º–∏—Ç–µ "–ö—É–ø–∏—Ç—å" –Ω–∞ —Ç–æ–≤–∞—Ä–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–ø–ª–∞—Ç—ã YooKassa

**–î–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã YooKassa:**
- –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞: `5555 5555 5555 4477`
- –û—Ç–∫–ª–æ–Ω—ë–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞: `5555 5555 5555 5599`
- CVC: –ª—é–±–æ–π
- –°—Ä–æ–∫: –ª—é–±–æ–π –±—É–¥—É—â–∏–π

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

1. –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á `live_hWErqH3d4iabfytcNhbWqttodx4d72oBKRvuGpoh_uU` - —ç—Ç–æ –±–æ–µ–≤–æ–π –∫–ª—é—á. –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª—é—á (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `test_`)
2. –ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–º–µ–Ω–∏—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. Shop ID –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ YooKassa –≤ —Ä–∞–∑–¥–µ–ª–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "–î–∞–Ω–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω–∞"

